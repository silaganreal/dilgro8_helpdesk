import{u as L,r as c,j as l}from"./app-DAO5kFVm.js";import{s as p,E as z,F as j}from"./notif-D7gKZA5Q.js";import{B as A}from"./button-BhInKCgm.js";import{L as R}from"./label-QPvM9LlY.js";import{D as U,a as k,b as M,c as P,d as H}from"./dialog-CnPWAN03.js";import"./index-gLVX-lnL.js";import"./x-2txf_BCB.js";import"./index-mEHlem1z.js";import"./index-BeyEb0N1.js";import"./index-syQ5x3WB.js";import"./createLucideIcon-DTyHuvVu.js";const T=["DEPARTMENT OF THE INTERIOR AND LOCAL GOVERNMENT","ICT TECHNICAL ASSISTANCE PROCESS SUMMARY LOGSHEET"],V="FM-QP-DILG-ISTMS-RO-17-03",_="2",Q="03.01.23",Y="(90%) within three (3) working days upon receipt of request or within agreed timeline",J="Quarterly",W="January 1, 2024 to present";function ie(){const{auth:u}=L().props,[g,I]=c.useState(""),[m,S]=c.useState(""),[w,v]=c.useState(!1),[x,y]=c.useState(!1),N=async(o,n)=>{const h=`/reports/daily-summary?${new URLSearchParams({from:o,to:n}).toString()}`,i=await fetch(h,{credentials:"same-origin"});if(!i.ok){const t=await i.text();throw new Error(`Server error: ${i.status} ${t}`)}return await i.json()},B=o=>{const n=new Date(o+"T00:00:00"),e={weekday:"long",year:"numeric",month:"long",day:"2-digit"};return n.toLocaleDateString(void 0,e)},$=async o=>{const n=new z.Workbook,e=n.addWorksheet("Process Summary");e.columns=[{width:35},{width:25},{width:25},{width:20},{width:25},{width:25},{width:20}];try{const r=await fetch("/dilg-logo.png");if(r.ok){const E=await r.blob(),C=await new Promise(d=>{const s=new FileReader;s.onload=()=>d(s.result),s.readAsArrayBuffer(E)}),a=n.addImage({buffer:C,extension:"png"});e.addImage(a,{tl:{col:.1,row:1},ext:{width:70,height:70}})}}catch{}e.mergeCells("B3:E3"),e.getCell("B3").value=T[0],e.getCell("B3").font={name:"Cambria",bold:!0,size:12},e.mergeCells("B4:D6"),e.getCell("B4").value=T[1],e.getCell("B4").font={name:"Cambria",size:18,bold:!0},e.getCell("B4").alignment={horizontal:"left",vertical:"top",wrapText:!0},e.mergeCells("F2:G2"),e.getCell("F2").value="Document Code",e.getCell("F2").font={color:{argb:"FFFFFF"},name:"Cambria",bold:!0},e.getCell("F2").alignment={horizontal:"left",vertical:"middle"},e.getCell("F2").fill={type:"pattern",pattern:"solid",fgColor:{argb:"000000"}},e.getCell("F2").border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.mergeCells("F3:G3"),e.getCell("F3").value=V,e.getCell("F3").font={name:"Cambria",bold:!0},e.getCell("F3").alignment={horizontal:"center",vertical:"middle"},e.getCell("F3").border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.getCell("F4").value="Rev No.",e.getCell("F4").fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF000000"}},e.getCell("F4").font={name:"Cambria",bold:!0,color:{argb:"FFFFFFFF"}},e.getCell("F4").alignment={horizontal:"center",vertical:"middle"},e.getCell("F4").fill={type:"pattern",pattern:"solid",fgColor:{argb:"000000"}},e.getCell("F4").border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.getCell("G4").value="Eff. Date",e.getCell("G4").fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF000000"}},e.getCell("G4").font={name:"Cambria",bold:!0,color:{argb:"FFFFFFFF"}},e.getCell("G4").alignment={horizontal:"center",vertical:"middle"},e.getCell("G4").fill={type:"pattern",pattern:"solid",fgColor:{argb:"000000"}},e.getCell("G4").border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.getCell("F5").value=_,e.getCell("F5").alignment={horizontal:"center",vertical:"middle"},e.getCell("F5").border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.getCell("G5").value=Q,e.getCell("G5").alignment={horizontal:"center",vertical:"middle"},e.getCell("G5").border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.getRow(7).height=30,e.mergeCells("A7:B7"),e.getCell("A7").value="QUALITY OBJECTIVE:",e.getCell("A7").font={name:"Cambria",bold:!0},e.getCell("A7").alignment={horizontal:"left",vertical:"bottom"},e.getCell("A7").border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.mergeCells("C7:G7"),e.getCell("C7").value=Y,e.getCell("C7").alignment={horizontal:"left",vertical:"bottom"},e.getCell("C7").border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.mergeCells("A8:B8"),e.getCell("A8").value="FREQUENCY OF MONITORING:",e.getCell("A8").font={name:"Cambria",bold:!0},e.getCell("A8").alignment={horizontal:"left",vertical:"middle"},e.getCell("A8").border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.mergeCells("C8:G8"),e.getCell("C8").value=J,e.getCell("C8").alignment={horizontal:"left",vertical:"middle"},e.getCell("C8").border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.mergeCells("A9:B9"),e.getCell("A9").value="CURRENT PERIOD:",e.getCell("A9").font={name:"Cambria",bold:!0},e.getCell("A9").alignment={horizontal:"left",vertical:"middle"},e.getCell("A9").border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.mergeCells("C9:G9"),e.getCell("C9").value=W,e.getCell("C9").alignment={horizontal:"left",vertical:"middle"},e.getCell("C9").border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.mergeCells("A10:G10"),e.getCell("A10").value="",e.mergeCells("C11:E11"),e.getCell("C11").value="OBJECTIVE 1",e.getCell("C11").alignment={horizontal:"center",vertical:"middle"},e.getCell("C11").font={bold:!0},e.getCell("C11").border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.mergeCells("F11:G11"),e.getCell("F11").value="OBJECTIVE 2",e.getCell("F11").alignment={horizontal:"center",vertical:"middle"},e.getCell("F11").font={bold:!0},e.getCell("F11").border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}};const h=e.addRow(["DATE",`TOTAL NUMBER OF REQUEST FOR TECHNICAL ASSISTANCE RECEIVED
(A)`,`TOTAL NUMBER OF TECHNICAL ASSISTANCE PROVISIONED WITHIN THREE (3) WORKING DAYS UPON RECEIPT OF REQUEST OR WITHIN AGREED TIMELINE
(B)`,`%
(B/A)*100`,`REMARKS
(Indicate reason if % is < 90%)`,`TOTAL NUMBER OF TECHNICAL ASSISTANCE WITH AN OVERALL QUALITY RATING OF 4.0 AND ABOVE
(C)`,`%
(C/A)*100`]);h.eachCell(r=>{r.font={bold:!0},r.alignment={horizontal:"center",vertical:"middle",wrapText:!0},r.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}});let i=h.number+1;o.forEach((r,E)=>{const C=e.addRow([B(r.date),r.count,r.count,null,"",r.count,null]),a=C.number;e.getCell(`D${a}`).value={formula:`IF(B${a}=0,0,C${a}/B${a})`},e.getCell(`D${a}`).numFmt="0%",e.getCell(`G${a}`).value={formula:`IF(B${a}=0,0,F${a}/B${a})`},e.getCell(`G${a}`).numFmt="0%",C.eachCell((d,s)=>{d.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},d.alignment=s===1?{horizontal:"right",vertical:"middle"}:{horizontal:"center",vertical:"middle"}})});const b=e.lastRow.number,t=b+1,O=e.addRow(["",0,0,null,"",0,null]),f=i,F=b;e.getCell(`B${t}`).value={formula:`SUM(B${f}:B${F})`},e.getCell(`C${t}`).value={formula:`SUM(C${f}:C${F})`},e.getCell(`F${t}`).value={formula:`SUM(F${f}:F${F})`},e.getCell(`D${t}`).value={formula:`IF(B${t}=0,0,C${t}/B${t})`},e.getCell(`D${t}`).numFmt="0%",e.getCell(`G${t}`).value={formula:`IF(B${t}=0,0,F${t}/B${t})`},e.getCell(`G${t}`).numFmt="0%",e.getCell(`B${t}`).numFmt="0",e.getCell(`C${t}`).numFmt="0",e.getCell(`F${t}`).numFmt="0",O.eachCell((r,E)=>{r.alignment={horizontal:"center",vertical:"middle"},r.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),e.views=[{state:"frozen",ySplit:12}],e.autoFilter={from:"A12",to:`G${e.lastRow?.number}`};const G=await n.xlsx.writeBuffer();j.saveAs(new Blob([G]),`ProcessSummary_Logsheet_${g}_to_${m}.xlsx`)},D=async()=>{if(!g||!m){p(u,"Validation","Please choose both From and To dates.");return}v(!0);try{const o=await N(g,m);await $(o),p(u,"Export ready","Process summary Excel has been downloaded.")}catch(o){console.error(o),p(u,"Export failed",o.message||"Could not generate report.")}finally{v(!1)}};return l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"",children:l.jsx(A,{onClick:()=>y(!0),className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Summary Logsheett"})}),l.jsx(U,{open:x,onOpenChange:y,children:l.jsxs(k,{className:"sm:max-w-md",children:[l.jsx(M,{children:l.jsx(P,{children:"Generate Process Summary Logsheet"})}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx(R,{children:"From"}),l.jsx("input",{type:"date",value:g,onChange:o=>I(o.target.value),className:"w-full mt-1 p-2 border rounded bg-white dark:bg-gray-800 dark:border-gray-600 dark:text-white"})]}),l.jsxs("div",{children:[l.jsx(R,{children:"To"}),l.jsx("input",{type:"date",value:m,onChange:o=>S(o.target.value),className:"w-full mt-1 p-2 border rounded bg-white dark:bg-gray-800 dark:border-gray-600 dark:text-white"})]})]}),l.jsx(H,{children:l.jsx(A,{disabled:w,onClick:async()=>{await D(),y(!1)},className:"bg-blue-600 hover:bg-blue-700 text-white",children:w?"Generating...":"Generate Summary"})})]})})]})}export{ie as default};
