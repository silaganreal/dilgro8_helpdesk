import{K as O,r as F,j as a}from"./app-DI05lpe_.js";import{s as E,E as D,F as G}from"./notif-Dq3ysLx0.js";import{B as L}from"./button-B4vSzJUQ.js";import{L as v}from"./label-DW1yuYrz.js";import"./index-Dzv1pc-R.js";const A=["DEPARTMENT OF THE INTERIOR AND LOCAL GOVERNMENT","ICT TECHNICAL ASSISTANCE PROCESS SUMMARY LOGSHEET"],z="FM-QP-DILG-ISTMS-RO-17-03",k="2",U="03.01.23",M="(90%) within three (3) working days upon receipt of request or within agreed timeline",j="Quarterly",P="January 1, 2024 to present";function J(){const{auth:c}=O().props,[g,R]=F.useState(""),[m,T]=F.useState(""),[p,w]=F.useState(!1),I=async(l,n)=>{const C=`/reports/daily-summary?${new URLSearchParams({from:l,to:n}).toString()}`,i=await fetch(C,{credentials:"same-origin"});if(!i.ok){const t=await i.text();throw new Error(`Server error: ${i.status} ${t}`)}return await i.json()},N=l=>{const n=new Date(l+"T00:00:00"),e={weekday:"long",year:"numeric",month:"long",day:"2-digit"};return n.toLocaleDateString(void 0,e)},S=async l=>{const n=new D.Workbook,e=n.addWorksheet("Process Summary");e.columns=[{width:35},{width:25},{width:25},{width:20},{width:25},{width:25},{width:20}];try{const o=await fetch("/dilg-logo.png");if(o.ok){const f=await o.blob(),h=await new Promise(d=>{const s=new FileReader;s.onload=()=>d(s.result),s.readAsArrayBuffer(f)}),r=n.addImage({buffer:h,extension:"png"});e.addImage(r,{tl:{col:.1,row:1},ext:{width:70,height:70}})}}catch{}e.mergeCells("B3:E3"),e.getCell("B3").value=A[0],e.getCell("B3").font={name:"Cambria",bold:!0,size:12},e.mergeCells("B4:D6"),e.getCell("B4").value=A[1],e.getCell("B4").font={name:"Cambria",size:18,bold:!0},e.getCell("B4").alignment={horizontal:"left",vertical:"top",wrapText:!0},e.mergeCells("F2:G2"),e.getCell("F2").value="Document Code",e.getCell("F2").font={color:{argb:"FFFFFF"},name:"Cambria",bold:!0},e.getCell("F2").alignment={horizontal:"left",vertical:"middle"},e.getCell("F2").fill={type:"pattern",pattern:"solid",fgColor:{argb:"000000"}},e.getCell("F2").border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.mergeCells("F3:G3"),e.getCell("F3").value=z,e.getCell("F3").font={name:"Cambria",bold:!0},e.getCell("F3").alignment={horizontal:"center",vertical:"middle"},e.getCell("F3").border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.getCell("F4").value="Rev No.",e.getCell("F4").fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF000000"}},e.getCell("F4").font={name:"Cambria",bold:!0,color:{argb:"FFFFFFFF"}},e.getCell("F4").alignment={horizontal:"center",vertical:"middle"},e.getCell("F4").fill={type:"pattern",pattern:"solid",fgColor:{argb:"000000"}},e.getCell("F4").border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.getCell("G4").value="Eff. Date",e.getCell("G4").fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF000000"}},e.getCell("G4").font={name:"Cambria",bold:!0,color:{argb:"FFFFFFFF"}},e.getCell("G4").alignment={horizontal:"center",vertical:"middle"},e.getCell("G4").fill={type:"pattern",pattern:"solid",fgColor:{argb:"000000"}},e.getCell("G4").border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.getCell("F5").value=k,e.getCell("F5").alignment={horizontal:"center",vertical:"middle"},e.getCell("F5").border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.getCell("G5").value=U,e.getCell("G5").alignment={horizontal:"center",vertical:"middle"},e.getCell("G5").border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.getRow(7).height=30,e.mergeCells("A7:B7"),e.getCell("A7").value="QUALITY OBJECTIVE:",e.getCell("A7").font={name:"Cambria",bold:!0},e.getCell("A7").alignment={horizontal:"left",vertical:"bottom"},e.getCell("A7").border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.mergeCells("C7:G7"),e.getCell("C7").value=M,e.getCell("C7").alignment={horizontal:"left",vertical:"bottom"},e.getCell("C7").border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.mergeCells("A8:B8"),e.getCell("A8").value="FREQUENCY OF MONITORING:",e.getCell("A8").font={name:"Cambria",bold:!0},e.getCell("A8").alignment={horizontal:"left",vertical:"middle"},e.getCell("A8").border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.mergeCells("C8:G8"),e.getCell("C8").value=j,e.getCell("C8").alignment={horizontal:"left",vertical:"middle"},e.getCell("C8").border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.mergeCells("A9:B9"),e.getCell("A9").value="CURRENT PERIOD:",e.getCell("A9").font={name:"Cambria",bold:!0},e.getCell("A9").alignment={horizontal:"left",vertical:"middle"},e.getCell("A9").border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.mergeCells("C9:G9"),e.getCell("C9").value=P,e.getCell("C9").alignment={horizontal:"left",vertical:"middle"},e.getCell("C9").border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.mergeCells("A10:G10"),e.getCell("A10").value="",e.mergeCells("C11:E11"),e.getCell("C11").value="OBJECTIVE 1",e.getCell("C11").alignment={horizontal:"center",vertical:"middle"},e.getCell("C11").font={bold:!0},e.getCell("C11").border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.mergeCells("F11:G11"),e.getCell("F11").value="OBJECTIVE 2",e.getCell("F11").alignment={horizontal:"center",vertical:"middle"},e.getCell("F11").font={bold:!0},e.getCell("F11").border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}};const C=e.addRow(["DATE",`TOTAL NUMBER OF REQUEST FOR TECHNICAL ASSISTANCE RECEIVED
(A)`,`TOTAL NUMBER OF TECHNICAL ASSISTANCE PROVISIONED WITHIN THREE (3) WORKING DAYS UPON RECEIPT OF REQUEST OR WITHIN AGREED TIMELINE
(B)`,`%
(B/A)*100`,`REMARKS
(Indicate reason if % is < 90%)`,`TOTAL NUMBER OF TECHNICAL ASSISTANCE WITH AN OVERALL QUALITY RATING OF 4.0 AND ABOVE
(C)`,`%
(C/A)*100`]);C.eachCell(o=>{o.font={bold:!0},o.alignment={horizontal:"center",vertical:"middle",wrapText:!0},o.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}});let i=C.number+1;l.forEach((o,f)=>{const h=e.addRow([N(o.date),o.count,o.count,null,"",o.count,null]),r=h.number;e.getCell(`D${r}`).value={formula:`IF(B${r}=0,0,C${r}/B${r})`},e.getCell(`D${r}`).numFmt="0%",e.getCell(`G${r}`).value={formula:`IF(B${r}=0,0,F${r}/B${r})`},e.getCell(`G${r}`).numFmt="0%",h.eachCell((d,s)=>{d.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},d.alignment=s===1?{horizontal:"right",vertical:"middle"}:{horizontal:"center",vertical:"middle"}})});const u=e.lastRow.number,t=u+1,B=e.addRow(["",0,0,null,"",0,null]),y=i,b=u;e.getCell(`B${t}`).value={formula:`SUM(B${y}:B${b})`},e.getCell(`C${t}`).value={formula:`SUM(C${y}:C${b})`},e.getCell(`F${t}`).value={formula:`SUM(F${y}:F${b})`},e.getCell(`D${t}`).value={formula:`IF(B${t}=0,0,C${t}/B${t})`},e.getCell(`D${t}`).numFmt="0%",e.getCell(`G${t}`).value={formula:`IF(B${t}=0,0,F${t}/B${t})`},e.getCell(`G${t}`).numFmt="0%",e.getCell(`B${t}`).numFmt="0",e.getCell(`C${t}`).numFmt="0",e.getCell(`F${t}`).numFmt="0",B.eachCell((o,f)=>{o.alignment={horizontal:"center",vertical:"middle"},o.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),e.views=[{state:"frozen",ySplit:12}],e.autoFilter={from:"A12",to:`G${e.lastRow?.number}`};const $=await n.xlsx.writeBuffer();G.saveAs(new Blob([$]),`ProcessSummary_Logsheet_${g}_to_${m}.xlsx`)},x=async()=>{if(!g||!m){E(c,"Validation","Please choose both From and To dates.");return}w(!0);try{const l=await I(g,m);await S(l),E(c,"Export ready","Process summary Excel has been downloaded.")}catch(l){console.error(l),E(c,"Export failed",l.message||"Could not generate report.")}finally{w(!1)}};return a.jsxs("div",{className:"flex justify-center items-center gap-3",children:[a.jsxs("div",{className:"flex gap-1 items-center",children:[a.jsx(v,{className:"text-gray-700 dark:text-gray-300",children:"From"}),a.jsx("input",{type:"date",value:g,onChange:l=>R(l.target.value),className:"border p-2 rounded bg-white dark:bg-gray-800 dark:border-gray-600 dark:text-white"})]}),a.jsxs("div",{className:"flex gap-1 items-center",children:[a.jsx(v,{className:"text-gray-700 dark:text-gray-300",children:"To"}),a.jsx("input",{type:"date",value:m,onChange:l=>T(l.target.value),className:"border p-2 rounded bg-white dark:bg-gray-800 dark:border-gray-600 dark:text-white"})]}),a.jsx("div",{className:"",children:a.jsx(L,{onClick:x,disabled:p,className:"bg-blue-600 hover:bg-blue-700 text-white",children:p?"Generating...":"Summary Logsheet"})})]})}export{J as default};
